var A=Object.defineProperty;var B=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var Y=(e,r,t)=>r in e?A(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,z=(e,r)=>{for(var t in r||(r={}))F.call(r,t)&&Y(e,t,r[t]);if(B)for(var t of B(r))U.call(r,t)&&Y(e,t,r[t]);return e};var w=(e,r,t)=>new Promise((o,n)=>{var c=y=>{try{b(t.next(y))}catch(M){n(M)}},p=y=>{try{b(t.throw(y))}catch(M){n(M)}},b=y=>y.done?o(y.value):Promise.resolve(y.value).then(c,p);b((t=t.apply(e,r)).next())});(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function t(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=t(n);fetch(n.href,c)}})();function N(e,r,t,o){return w(this,null,function*(){return new Promise(n=>{const c=Object.keys(r).map(p=>`${p} ${Math.round(t)}ms ${o}`).join(",");e.style.transition=c,setTimeout(()=>{Object.assign(e.style,r)},1),setTimeout(()=>{e.style.transition="",n()},t+50)})})}const X=e=>e?[...e.parentElement.children].reduce((r,t,o)=>t===e?o:r,-1):-1,P=e=>Array.from(document.querySelectorAll(e)),d=e=>P(e)[0],$=e=>{const r=document.createElement("temp");return r.innerHTML=d("template#"+e).innerHTML.trim(),r.firstChild};function D(e,r){return e=Math.ceil(e),r=Math.floor(r),Math.floor(Math.random()*(r-e))+e}function H(...e){e.forEach(r=>r.style.display="inherit")}function O(...e){e.forEach(r=>r.style.display="none")}function q(e,r){return{VerticalBottomToTop:()=>{const t=[];let o=r+0,n=3;for(;--o>-1&&t.length<n;)t.push([e,o]);for(t.reverse(),t.push([e,r]),o=r+0,n=t.length+3;++o<8&&t.length<n;)t.push([e,o]);return t},HorizontalLeftToRight:()=>{const t=[];let o=e+0,n=3;for(;--o>-1&&t.length<n;)t.push([o,r]);for(t.reverse(),t.push([e,r]),o=e+0,n=t.length+3;++o<8&&t.length<n;)t.push([o,r]);return t},DiagonalBottomLeftToTopRight:()=>{const t=[];let o=e+0,n=r+0,c=3;for(;--o>-1&&--n>-1&&t.length<c;)t.push([o,n]);for(t.reverse(),t.push([e,r]),o=e+0,n=r+0,c=t.length+3;++o<8&&++n<8&&t.length<c;)t.push([o,n]);return t},DiagonalTopLeftToBottomRight:()=>{const t=[];let o=e+0,n=r+0,c=3;for(;--o>-1&&++n<8&&t.length<c;)t.push([o,n]);for(t.reverse(),t.push([e,r]),o=e+0,n=r+0,c=t.length+3;++o<8&&--n>-1&&t.length<c;)t.push([o,n]);return t}}}function k(e,r){const t=q(e,r);return[t.DiagonalBottomLeftToTopRight(),t.DiagonalTopLeftToBottomRight(),t.HorizontalLeftToRight(),t.VerticalBottomToTop()].filter(o=>o.length>=4).reduce((o,n)=>(n.length>4?(o.push(n.slice(0,4)),o.push(n.reverse().slice(0,4).reverse())):o.push(n),o),[])}const W=6,I=7,V={player1:"Red Wins!",player2:"Yellow Wins!"},E={defaultState:{currentPlayer:"player1",aiPlayers:["player2"],history:[],dropping:0},defaultColumns:""};Object.freeze(E);function _(){const e=z({},E.defaultState);globalThis.state=()=>e;const r=$("checker"),t=s=>{const a=r.cloneNode(!0);return a.classList.add(s),a},o=()=>{e.dropping||O(i.gameStart)},n=()=>w(this,null,function*(){if(e.dropping)return;i.columns.style.top="0px";const s=Math.round(window.outerHeight+window.outerHeight/2);N(i.columns,{transform:"translateY("+s+"px)"},s/2.5,"cubic-bezier(0.33333, 0, 0.66667, 0.33333)").then(()=>{i.columns.style.transform="",i.columns.style.transition="",i.columns.style.top="0px",[...i.columns.children].forEach(a=>a.innerHTML="")}),p(E.defaultState),O(i.gameOver),O(i.gameTie)}),c=(s,a)=>e.history.find(l=>l.x===s&&l.y===a),p=s=>Object.assign(e,s),b=(s,a)=>k(s,a).some(m=>m.every(T=>{var g;return((g=c(...T))==null?void 0:g.player)===e.currentPlayer})),y=()=>e.history.length===64,M=s=>{i.nextChecker.style.left=s*i.size.clientWidth+"px"},x=s=>w(this,null,function*(){if(e.dropping)return;const a=L(s);if(a<0)return Promise.resolve();p({dropping:e.dropping+1});const l=t(e.currentPlayer);try{i.column[s].appendChild(l)}catch(f){throw console.log(s,e.currentPlayer),f}const m=l.offsetTop+l.getBoundingClientRect().height,T=i.nextChecker.offsetTop;i.nextChecker.style.opacity="0",l.style.top=T+"px",l.style.position="fixed";const h=(Math.abs(a-W)+1)*75;if(yield N(l,{transform:"translateY("+(m-T)+"px)"},h,"cubic-bezier(0.33333, 0, 0.66667, 0.33333)"),l.style.transform="",l.style.position="relative",l.style.top="",i.nextChecker.style.opacity="1",p({history:[...e.history,{x:s,y:a,player:e.currentPlayer}]}),b(s,a)){i.winMessage.innerText=V[e.currentPlayer],H(i.gameOver),p({dropping:e.dropping-1});return}if(y()){H(i.gameTie),p({dropping:e.dropping-1});return}const u=e.currentPlayer==="player1"?"player2":"player1";p({dropping:e.dropping-1,currentPlayer:u}),e.aiPlayers.includes(u)&&(yield j())}),L=s=>{var l;if(!i.column[s])return-1;const a=(l=i.column[s])==null?void 0:l.children.length;return a<W?a:-1},j=()=>w(this,null,function*(){const s=e.history[e.history.length-1],a=(g,h)=>g.map(u=>({matches:u.filter(f=>{var v;return((v=c(...f))==null?void 0:v.player)===h}).length,moves:u.filter(f=>L(f[0])===f[1])})).filter(u=>u.moves.length>0).sort((u,f)=>u.matches===f.matches?u.moves>f.moves?-1:u.moves<f.moves?1:0:u.matches>f.matches?-1:u.matches<f.matches?1:0),l=e.history.length?k(s.x,s.y):[];let m=null;const T=a(l,s.player);if(T.length&&T.some(g=>{let h=g.moves[0];if(h[1]===I)return m=h[0],!0;const u=[h[0],h[1]+1];if(k(u[0],u[1]).map(v=>({matches:v.filter(C=>{var S;return((S=c(...C))==null?void 0:S.player)===s.player}).length})).sort((v,C)=>v.matches>C.matches?-1:v.matches<C.matches?1:0).every(v=>v.matches<3))return m=h[0],!0}),m===null){let g=[];for(let h=0;h<7;h++)console.log(h),L(h)!==-1&&g.push(h);return console.log({availableColumns:g}),g[D(0,g.length)]}return x(m)}),i={board:d("#board"),columns:d("#board .columns"),size:d("#size"),gameOver:d("#game-over"),gameTie:d("#game-tie"),gameStart:d("#game-start"),resetButtons:P(".reset-btn"),startButton:d("#start-btn"),buttons:P("#board button"),spacesWrapper:P("#board .spaces"),winMessage:d(".win-message"),checkers:d(".checkers"),next:d(".next .track"),nextChecker:t("player1"),column:[]};i.gameStart.style.display="flex",i.next.appendChild(i.nextChecker),i.column=[...i.columns.children];const R=(s,a)=>{const l=s.target;if(!l.classList.contains("column"))return;const m=X(l);if(m===-1||m>=i.column.length){console.error("column not found ",{event:s,element:l,index:m});return}a(m)};i.board.onmouseover=s=>R(s,M),i.board.onclick=s=>R(s,x),i.startButton.onclick=o,i.resetButtons.forEach(s=>s.onclick=n),globalThis.app=()=>i}for(let e=0;e<1e6;e++){const r=D(0,7);r===7&&console.log(r)}addEventListener("load",_);
